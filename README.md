# Gotham

_Not the Go compiler we need, but the Go compiler we deserve._

A miniature Go compiler written using lex and yacc. Project component for the
UE18CS351 Compiler Design course.


## Status

The following stages have been implemented so far:
-   Lexical Analysis
-   Syntax Analysis
-   Semantic Analysis
-   Symbol Table Generation
-   Intermediate Code Generation
-   Intermediate Code Optimization

The following constructs are supported by the Go compiler so far:
-   int, float32, string and bool data types (till STG)
-   functions (till STG)
-   block statements with scopes (till STG)
-   if-else statements (till ICG)
-   for loops (till ICG)
-   most arithmetic and logical operations (till ICO)


## Sample Input and Output

Given a sample Go program:

```go
package main

import "fmt"

func main() int {
	var a int = 10 / 5 + 8
	var q int = 9 * 9
	var c int = 10 - 2 + a
	var d int = c
	var e int = c - 5
	var f int = c + 5

	fmt.Println(d)
}
```

the following Intermediate Code is generated by the compiler:
```as
DIV      10      5       t1
ADD      t1      8       t2
ASSIGN   t2              a
MUL      9       9       t3
ASSIGN   t3              q
SUB      10      2       t4
ADD      t4      a       t5
ASSIGN   t5              c
ASSIGN   c               d
SUB      c       5       t6
ASSIGN   t6              e
ADD      c       5       t7
ASSIGN   t7              f
PARAMS                   d
CALL                     PRINT
```

which can be optimized down to:
```as
PARAMS	18
CALL	PRINT
```


## Building and Execution

### On host machines:

Dependencies:
-   flex (an implementation of lex)
-   bison (an implementation of yacc)
-   python3

These can be installed via distribution specific package managers.

Once dependencies are met, the compiler can be built using make:
```
make
```

Then the compiler accepts a Go program through stdin:
```
./gotham < test.go
```

### Using docker

A docker container can be used to isolate the running environment.

While in the repository folder, the docker image for the compiler can be
built using:
```
docker build -t gotham .
```

Then the docker image can be run as a container, with the repository mounted
on it.
```
docker run --rm -it -v $GOTHAM_PATH:/gotham gotham bash
```

where $GOTHAM_PATH should be replaced with the full path to the
repository folder.

Running the command gives an interactive terminal, in which the previous
build and execution instructions using make can be run.
